---
layout: post
title: Use Azure DevOps Release Gates to check for website availability and automate
  stage flows
date: '2019-03-20T19:41:00.001Z'
author: Matteo Emili
tags: 
modified_time: '2019-03-20T19:59:52.478Z'
thumbnail: https://3.bp.blogspot.com/-juyhg2OjbPc/XJIQawCKVOI/AAAAAAAAFc0/O5Evs1UmLvMslQ1rLzECo0QwNnfhUErdwCLcBGAs/s72-c/function4.png
blogger_id: tag:blogger.com,1999:blog-9050180307874313601.post-3691338432858685257
blogger_orig_url: https://mattvsts.blogspot.com/2019/03/use-azure-devops-release-gates-to-check.html
---

<div dir="ltr" style="text-align: left;" trbidi="on">Modern deployment patterns rely on automation, everywhere. A common request in this space is to automatically verify if a web resource is up and running before proceeding with the deployment.<br /><br />Instead of having a script that runs within a Stage, why not leveraging Release Gates? At the end of the day they are designed with automation in mind.<br /><br />To make this example generic enough, I created an Azure Function (<a href="https://github.com/MattVSTS/AvailabilityFunction">code here</a>) based off the HttpTrigger sample that checks for a URL availability. If the code is not 4xx or 5xx it returns a simple JSON output:<br /><br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-juyhg2OjbPc/XJIQawCKVOI/AAAAAAAAFc0/O5Evs1UmLvMslQ1rLzECo0QwNnfhUErdwCLcBGAs/s1600/function4.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="897" data-original-width="879" height="640" src="https://3.bp.blogspot.com/-juyhg2OjbPc/XJIQawCKVOI/AAAAAAAAFc0/O5Evs1UmLvMslQ1rLzECo0QwNnfhUErdwCLcBGAs/s640/function4.png" width="626" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />It is not the coolest or cleanest code, but it works üòÅ Now, once this Function is up and running, we can leverage it within a Release Gate in a Pre-deployment condition:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-24enRHPal28/XJIODHbxEYI/AAAAAAAAFcg/CPRYCe5sS6ctnsxplnLjFM7p9gdXQHQ1wCLcBGAs/s1600/function0.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="342" data-original-width="482" height="283" src="https://2.bp.blogspot.com/-24enRHPal28/XJIODHbxEYI/AAAAAAAAFcg/CPRYCe5sS6ctnsxplnLjFM7p9gdXQHQ1wCLcBGAs/s400/function0.png" width="400" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />Set the Completion event to <b>ApiResponse</b>, and check the value of the output as a <b>Success criteria</b>. If IsUp is true, then the website is up and running:<br /><br /><a href="https://3.bp.blogspot.com/-Hxn4KIXiCKk/XJIOCxb0loI/AAAAAAAAFcY/gL00LCM9ycUEvKnrPMpPaElXWSxd6Of3gCLcBGAs/s1600/function1.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="98" data-original-width="239" src="https://3.bp.blogspot.com/-Hxn4KIXiCKk/XJIOCxb0loI/AAAAAAAAFcY/gL00LCM9ycUEvKnrPMpPaElXWSxd6Of3gCLcBGAs/s1600/function1.png" /></a><br /><br /><br /><br /><br /><br /><br /><br /><br />You can actually make it even smarter by checking for both IsUp and the code:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-lzzEqcFqX4E/XJIODC-2obI/AAAAAAAAFcc/48KKyTSVLikgky294TQDsDEcMcRmoYVaQCLcBGAs/s1600/function2.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="80" data-original-width="340" src="https://2.bp.blogspot.com/-lzzEqcFqX4E/XJIODC-2obI/AAAAAAAAFcc/48KKyTSVLikgky294TQDsDEcMcRmoYVaQCLcBGAs/s1600/function2.png" /></a></div><br /><br /><br /><br /><br /><br />This would be enough to have the check in place, and automate the gatekeeping of your stage flow.</div>