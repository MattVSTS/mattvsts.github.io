---
layout: post
title: A simple VSTS-based pipeline for Java Web Applications
date: '2016-06-13T11:19:00.001+01:00'
author: Matteo Emili
tags: 
modified_time: '2016-06-13T13:39:57.235+01:00'
thumbnail: https://lh3.googleusercontent.com/-tkrNjhosbSg/V16pimhgwsI/AAAAAAAADVA/3DClSFbmCuM/s72-c/j1_thumb%25255B1%25255D.png?imgmax=800
blogger_id: tag:blogger.com,1999:blog-9050180307874313601.post-1443412575488967595
blogger_orig_url: https://mattvsts.blogspot.com/2016/06/a-simple-vsts-based-pipeline-for-java.html
---

<p>I took the plunge last weekend about building a pipeline for a very simple Java application, and it was very, very easy to do so.</p> <p>The app in question is <a href="https://github.com/Microsoft/deep-space">DeepSpace</a>. It is written in Java and AngularJS, so it looked like it was perfect for my requirement. It is used in the VSTS Java demos, but I didn’t want to go down that route because of the deployment approach.</p> <p>What I wanted to throw in the mix is Azure Resource Manager of course, I am not going to use FTP and manual credentials from a .publishsettings file anymore! So the first thing I did was to create an ARM template for my website.</p> <p>What does it take to deploy such an application on VSTS? Well, I would say around ten minutes, tops. I realised Donovan Brown <a href="http://donovanbrown.com/post/2016/03/04/Deploying-Maven-project-to-Azure-Web-App">did</a> the same thing, it would have saved me a bit of research!</p> <p>Start with the build: VSTS has Maven running in the Hosted Build, so there is no setup cost you need to factor in for the build server:</p> <p><a href="https://lh3.googleusercontent.com/-b3-wfSJkpKc/V16ph7n-baI/AAAAAAAADU0/gX12dp3wcOU/s1600-h/j1%25255B3%25255D.png"><img title="j1" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="j1" src="https://lh3.googleusercontent.com/-tkrNjhosbSg/V16pimhgwsI/AAAAAAAADVA/3DClSFbmCuM/j1_thumb%25255B1%25255D.png?imgmax=800" width="524" height="221"></a></p> <p>The <strong>pom.xml</strong> file is kindly provided by DeepSpace, but it would not take long to have one. You can see I am packaging the application (so I would get a .war file, more to come later on the matter) and I am using <strong>JaCoCo</strong> for Code Coverage – again provided by the Hosted Build.</p> <p>The next step is publishing the artifacts to VSTS. Nothing really fancy here – just push the <strong>.json</strong> and <strong>.war</strong> files.</p> <p><a href="https://lh3.googleusercontent.com/-yPJfc5w5RZY/V16pjVRkNLI/AAAAAAAADVM/7KOBQh73PRI/s1600-h/j2%25255B3%25255D.png"><img title="j2" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="j2" src="https://lh3.googleusercontent.com/-qdpWiPjIKG8/V16pkDi243I/AAAAAAAADVY/Vag1yn33y40/j2_thumb%25255B1%25255D.png?imgmax=800" width="524" height="123"></a></p> <p>So, we built our stuff. Now we want to push it to Azure I reckon. Release Management is definitely the right tool for this job.</p> <p>I am using the Trackyon Advantage task like Donovan because I realised Tomcat is not exposed if you create a Java-based Azure Web Site with ARM, and you can’t change its configuration because it would be running under <strong>Program Files</strong>, where the user doesn’t have edit permissions. </p> <p>By the way, if you want to have a look at what happens to your Azure Web Site, at what’s inside and if you want to run a cmd, browse to <a href="http://yoursite.scm.azurewebsites.net">http://yoursite.scm.azurewebsites.net</a>, where Kodu would provide a great amount of information and you can actually browse and edit (where possible) things.</p> <p>So, back to RM – I am going to change the format of the .war file to a .zip <strong>compatible with MSDeploy</strong> so I can reuse the <strong>Azure Web App Deployment</strong> task and I am not going to fiddle with Tomcat (which means not getting near any credential or custom file modifications, which in turn is very good for automation!). If instead you need/can access Tomcat, use the <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscs-rm.apachetomcat">VSTS extension</a> for this.</p> <p>I am literally just providing paths here:</p> <p><a href="https://lh3.googleusercontent.com/-6iW2s08zkFE/V16plIt-iLI/AAAAAAAADVk/_wl2IuxHenY/s1600-h/j3%25255B3%25255D.png"><img title="j3" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="j3" src="https://lh3.googleusercontent.com/-00LfkOaqLOo/V16plz-dWHI/AAAAAAAADVw/bHWQxGqFmUQ/j3_thumb%25255B1%25255D.png?imgmax=800" width="524" height="149"></a></p> <p>Then I am going to deploy my ARM template as usual (it is made of a single Website and Azure App Service at the minute), and I am pushing my Web App as well:</p> <p><a href="https://lh3.googleusercontent.com/-zz5_0lHeLXc/V16pmqW35YI/AAAAAAAADV8/G-ZdoGwcrEc/s1600-h/j4%25255B3%25255D.png"><img title="j4" style="border-top: 0px; border-right: 0px; background-image: none; border-bottom: 0px; padding-top: 0px; padding-left: 0px; border-left: 0px; display: inline; padding-right: 0px" border="0" alt="j4" src="https://lh3.googleusercontent.com/-lR3y8LOQ3t0/V16pnO3pUYI/AAAAAAAADWI/7khgLDKgBpA/j4_thumb%25255B1%25255D.png?imgmax=800" width="524" height="166"></a></p> <p>That’s it! I wasn’t expecting it to be that easy – the only place where I stumbled was the war to zip conversion.</p> <p>What I did was searching on the Marketplace for “<a href="https://marketplace.visualstudio.com/search?term=war%20zip&amp;target=VSTS&amp;sortBy=Relevance">war zip</a>”, I had a look and Trackyon Advantage was there among the other five results. I looked at the description and it did what I was searching for. There is literally an extension for everything these days!</p> <p>Of course the pipeline lacks stages, approvals and all the rest. But this is what I put together in around an hour, so it is a great starting point!</p>