---
layout: post
title: Donâ€™t overlook the details during a TFS outage
date: '2018-01-10T21:11:00.003Z'
author: Matteo Emili
tags: 
modified_time: '2018-01-10T21:11:57.918Z'
blogger_id: tag:blogger.com,1999:blog-9050180307874313601.post-724909209484382685
blogger_orig_url: https://mattvsts.blogspot.com/2018/01/dont-overlook-details-during-tfs-outage.html
---

<div dir="ltr" style="text-align: left;" trbidi="on"><div class="MsoNormal">Two weeks ago I dealt with a head-scratching outage. A few minutes of downtime, for a very stupid reason.<o:p></o:p></div><div class="MsoNormal"><br /></div><div class="MsoNormal">So, we are starting in a situation of total outage. All the services which rely on the production AlwaysOn Availability Group cannot connect to the server. People start screaming, emails flow in at a rate of tens-per-secondâ€¦ well it wasn't that bad, but you get the idea <span style="font-family: &quot;Segoe UI Emoji&quot;,sans-serif; mso-ascii-font-family: Calibri; mso-ascii-theme-font: minor-latin; mso-char-type: symbol-ext; mso-hansi-font-family: Calibri; mso-hansi-theme-font: minor-latin; mso-symbol-font-family: &quot;Segoe UI Emoji&quot;;">ðŸ˜Š</span> outages are always annoying.<o:p></o:p></div><div class="MsoNormal"><br /></div><div class="MsoNormal">So off we go with the usual stuff â€“ the TFS Management Console does not load any data from the Data Tier, so the first point of call is checking the database servers.<o:p></o:p></div><div class="MsoNormal"><br /></div><div class="MsoNormal">Which are humming along totally fine. What the hell?! The network stack works as expected, I can ping all the machines involved!<o:p></o:p></div><div class="MsoNormal"><br /></div><div class="MsoNormal">When checking the database servers, I can see that the Availability Group is totally fine â€“ everything is green, synchronised and with no issues. While this is very good on its own (no backups to restore, nothing to sweat too much about), it still does not explain why the Application Tier cannot talk to the Data Tier.<o:p></o:p></div><div class="MsoNormal"><br /></div><div class="MsoNormal">Then the awakening â€“ whenever I try to connect to the AlwaysOn Listener I get a network error, while going directly to the database server works without problems. There it is!<o:p></o:p></div><div class="MsoNormal"><br /></div><div class="MsoNormal">Pinging the Listener does not work indeed. But why? All the cluster resources were green, online.&nbsp;</div><div class="MsoNormal">But for some reason the affected resource failed to perform its duties.</div><div class="MsoNormal"><br /></div><div class="MsoNormal"><o:p></o:p></div><br /><div class="MsoNormal">Given that all the other moving pieces were perfectly fine, a manual AlwaysOn failover solved the problem. The lesson learned here is that in a complex architecture there is always something unnoticeable but critical â€“ itâ€™s like breaking a malleolus.&nbsp;<o:p></o:p></div></div>