---
layout: post
title: Unorthodox reporting with TFS/VSTS and PowerQuery
date: '2017-11-06T12:11:00.001Z'
author: Matteo Emili
tags: 
modified_time: '2017-11-06T12:11:45.860Z'
thumbnail: https://lh3.googleusercontent.com/-fbetLY7P8II/WgBQpfpIj5I/AAAAAAAAEqE/vxOKPIp0i_4H93iEAva1-gB9sZqIF8yMACHMYCw/s72-c/image_thumb%255B1%255D?imgmax=800
blogger_id: tag:blogger.com,1999:blog-9050180307874313601.post-6729555733217284173
blogger_orig_url: https://mattvsts.blogspot.com/2017/11/unorthodox-reporting-with-tfsvsts-and.html
---

<p>I am a huge Excel fan, because it allows easy data transformation and its flexibility is second to none, despite its complexity. But I also use other tools, depending on the requirements.</p><p>Many users instead only use Excel, with no possible alternative. Good or bad, this is the norm in many organisations and trying to change this habit too early while trying to push new concepts or ideas only puts strain on these users, raising barriers and potentially preventing the very change we are pursuing.</p><p>That is where PowerQuery comes to the rescue. Ironically enough, I discovered it <em>by accident</em> trying to help my partner with some stuff from her work (she is a heavy Excel user) – PowerQuery is a very powerful data analysis engine (it goes hand to hand with <a href="https://mattvsts.blogspot.co.uk/2014/07/tfs-audits-how-to-create-reports-on.html">PowerPivot</a>, another Excel Data Modelling tool I am really fond of!) that, in a nutshell and from a developer point of view, enables database-like querying and reporting scenarios.</p><p>So what can you do with it? Well, let’s take a very easy example: you have a TFS/VSTS query which returns all the non-done PBIs in a backlog, and you want to report on this query so you will know how many Work Items you have in a certain state, but <strong>without using TFS or VSTS at all</strong>.</p><p><a href="https://lh3.googleusercontent.com/-RxMgRl5l8SU/WgBQoPSWrCI/AAAAAAAAEqA/Cq67KDR2MlMQfYy5klWQsCjjQZy9urANwCHMYCw/s1600-h/image%255B3%255D"><img width="504" height="142" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-fbetLY7P8II/WgBQpfpIj5I/AAAAAAAAEqE/vxOKPIp0i_4H93iEAva1-gB9sZqIF8yMACHMYCw/image_thumb%255B1%255D?imgmax=800" border="0"></a></p><p>That is where Excel comes easily to the rescue: you can connect it to TFS/VSTS with the Team Add-in, downloading the raw data from the query you saved there:</p><p><a href="https://lh3.googleusercontent.com/-J6-bVbcS1Dg/WgBQqwoKNaI/AAAAAAAAEqI/vSO3_ro4VbYKGLVTaq19aT6xUmcJyiiZQCHMYCw/s1600-h/image%255B10%255D"><img width="504" height="152" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-yzyc_LS9Z_8/WgBQsVoaBtI/AAAAAAAAEqM/yaNxZVoyUwA_S75MhSBAMeuYb-ZhDJaBgCHMYCw/image_thumb%255B4%255D?imgmax=800" border="0"></a></p><p><a href="https://lh3.googleusercontent.com/-pfJMlo8JKS4/WgBQtrjPnPI/AAAAAAAAEqQ/KmR87WfTz_sMVT5Q7swGNMglPkqMDJAugCHMYCw/s1600-h/image%255B14%255D"><img width="504" height="104" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-B-IEVQZdyuM/WgBQuy_fulI/AAAAAAAAEqU/c4OzIFiajmAHCp2Q4PEz47my5qDzUbEaACHMYCw/image_thumb%255B6%255D?imgmax=800" border="0"></a></p><p>Select the raw data you want to use and from the Data ribbon, select <strong>From Table</strong>. Excel will automatically recognise the data source you want to use, if you don’t select data beforehand you’d have to input the range manually.</p><p><a href="https://lh3.googleusercontent.com/-vCUBkhawaLY/WgBQweR5BII/AAAAAAAAEqY/JSf2jCI1OZw9ngvRpCGA4Z0_dHC47mcswCHMYCw/s1600-h/image%255B17%255D"><img width="208" height="142" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-LwaJL7gEr84/WgBQxvyC0OI/AAAAAAAAEqc/v1lDW8PDhzQ4vuDEyD6jDzDxL2-94ACWwCHMYCw/image_thumb%255B7%255D?imgmax=800" border="0"></a></p><p>PowerQuery now kicks in:</p><p><a href="https://lh3.googleusercontent.com/-vOauBQGPqvk/WgBQzQrD7YI/AAAAAAAAEqg/h274YB7TLNg0zK1tod0fEwm7mGtdbKOdQCHMYCw/s1600-h/image%255B21%255D"><img width="504" height="192" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-IyCe8AGjwfc/WgBQ1DDDjXI/AAAAAAAAEqk/iYd1pGaggAw70OSR2-TzMd8sznBm7NbygCHMYCw/image_thumb%255B9%255D?imgmax=800" border="0"></a></p><p>What we want to do is pretty easy and straightforward, so we are going to use <strong>Group By</strong>:</p><p><a href="https://lh3.googleusercontent.com/-xvmrAfyfEUk/WgBQ2Qu2pOI/AAAAAAAAEqo/epzJzxiwRmo3N_m1yWZ87NU_sHJ-ie8xgCHMYCw/s1600-h/image%255B24%255D"><img width="244" height="94" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-dvJaGVr8eBE/WgBQ3xjT8_I/AAAAAAAAEqs/nOflwm5Vmd8fl_88eknXySmiQ8I13JQaQCHMYCw/image_thumb%255B10%255D?imgmax=800" border="0"></a></p><p>A basic group by works well here:</p><p><a href="https://lh3.googleusercontent.com/-ftoZuEd8_sg/WgBQ5Pv-RBI/AAAAAAAAEqw/DOXaJOcajL4tAotk63Tb-A409oxk3ufAwCHMYCw/s1600-h/image%255B37%255D"><img width="504" height="314" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-RCFL2TPQEDc/WgBQ6kbr69I/AAAAAAAAEq0/VKyZujDYKesAdVWL6oX_VqloL_snwN8PgCHMYCw/image_thumb%255B15%255D?imgmax=800" border="0"></a><a href="https://lh3.googleusercontent.com/-i4LBU2vE2n8/WgBQ7khGrdI/AAAAAAAAEq4/8jnx5BrpQiopVFaeOp0H8gPw7qlIZILSQCHMYCw/s1600-h/image%255B40%255D"><img width="308" height="116" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-wDSVM3gae84/WgBQ8vs-cwI/AAAAAAAAEq8/vRIH9ECCdXszojsw2_7YElHcH4v1P_SRgCHMYCw/image_thumb%255B18%255D?imgmax=800" border="0"></a></p><p>If you use an advanced one you can group by based on multiple columns. If you have bugs as well as PBIs as requirements, that’s what you want:</p><p><a href="https://lh3.googleusercontent.com/-PMTdEes_3HY/WgBQ-JgwUQI/AAAAAAAAErA/7zQnXCdDN4YIymtXMcQGWUIrgv264rKbgCHMYCw/s1600-h/image%255B38%255D"><img width="504" height="554" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Yd7n2_aIHXc/WgBQ_MuJnfI/AAAAAAAAErE/2wZVLUNdaJkxrt41tIFG5gnDUkpeMuiMwCHMYCw/image_thumb%255B16%255D?imgmax=800" border="0"></a></p><p><a href="https://lh3.googleusercontent.com/-K5xTXRFf6To/WgBRAQ8xmJI/AAAAAAAAErI/BaSeF-ddYtU_vA8ac_UC18QL7eMokfTXwCHMYCw/s1600-h/image%255B39%255D"><img width="454" height="111" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/--jvtput52wY/WgBRBtzySjI/AAAAAAAAErM/QSgY3SVrlow8sJpOVdQGAuVjRRoBNo-9wCHMYCw/image_thumb%255B17%255D?imgmax=800" border="0"></a></p><p>Now, if you Close &amp; Load, you are done. How is this useful in any way?</p><p><a href="https://lh3.googleusercontent.com/-HW8J8EQSm0o/WgBRCyEvX3I/AAAAAAAAErQ/5igGaLFvkcYsiyO3s2CwhZWxLtujNJSNQCHMYCw/s1600-h/image%255B43%255D"><img width="78" height="144" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-J7fOA05KhIk/WgBREcPRYJI/AAAAAAAAErU/dz2cR1Aw0Eg8jXpsNPlqks2U9aRHetu6wCHMYCw/image_thumb%255B19%255D?imgmax=800" border="0"></a></p><p>Easy: this query is going to show on the side of your spreadsheet:</p><p><a href="https://lh3.googleusercontent.com/-S4bQXoddXtc/WgBRFxY6G3I/AAAAAAAAErY/zs2-gQAOYhImajnoaXMVcptisMPn4ISywCHMYCw/s1600-h/image%255B47%255D"><img width="504" height="248" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-8GYeGHFyngs/WgBRHv7q1HI/AAAAAAAAErg/MfA2K2SlOZwkZSy6VRVltcFs06W4u-pBQCHMYCw/image_thumb%255B21%255D?imgmax=800" border="0"></a></p><p>Click on the Query you created, and you will be immediately shown the result:</p><p><a href="https://lh3.googleusercontent.com/-TcSPpqIyYGs/WgBRIz2W4QI/AAAAAAAAErk/97tdJLAl2pY-DZy9QGmkvnM-51sTdilhACHMYCw/s1600-h/image%255B54%255D"><img width="204" height="96" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-I-zKyDJzE7k/WgBRKJmDHcI/AAAAAAAAEro/0KmatsIaMg0vh_4ash5GVk3iFLyM4xEFwCHMYCw/image_thumb%255B24%255D?imgmax=800" border="0"></a>or <a href="https://lh3.googleusercontent.com/-ZTyA7ecd1UQ/WgBRLbrENfI/AAAAAAAAErs/2pVDL_3KCqUrZ4yet4TgH6wIX5X6STjlgCHMYCw/s1600-h/image%255B55%255D"><img width="204" height="64" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/--BK6qd5jwwo/WgBRNIpjjMI/AAAAAAAAErw/B_dv46w5__coiiank7gTXzUFOP_SfWXiwCHMYCw/image_thumb%255B25%255D?imgmax=800" border="0"></a></p><p>Moreover, it is quite dynamic.</p><p>Going deeper on it, the name isn’t cool at all – VSTS_&lt;GUID&gt; doesn’t say much. You can change it in the Query Editor:</p><p><a href="https://lh3.googleusercontent.com/-B1RYP-_GpWI/WgBROAdCkiI/AAAAAAAAEr0/fh-XdPZtEacfSd0cTGUfUL70P_NKCxDdQCHMYCw/s1600-h/image%255B58%255D"><img width="244" height="171" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-M6_EZdb2SF8/WgBRPqu8U_I/AAAAAAAAEr4/iqwmUfPQ6BAD9eZUzhXUwV7xZg8xSUWxQCHMYCw/image_thumb%255B26%255D?imgmax=800" border="0"></a></p><p>Underneath you can see the Applied Steps – that is where things get interesting:</p><p><a href="https://lh3.googleusercontent.com/-orlNUxtAEck/WgBRQ5cma6I/AAAAAAAAEr8/Jfej2fSPUsYijGUYZMVdbXq0RPqu5P0nACHMYCw/s1600-h/image%255B61%255D"><img width="244" height="109" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-FJ3XMeFa9ek/WgBRSL3BatI/AAAAAAAAEsA/dp226DRgCUc7-oD_d6aYMoHBME7vNG4VgCHMYCw/image_thumb%255B27%255D?imgmax=800" border="0"></a></p><p>It is the visual representation of all the data transformation you applied. If you want to access these steps and change them, click on the Advanced Editor:</p><p><a href="https://lh3.googleusercontent.com/-bvL5J-gPFV4/WgBRTciVfRI/AAAAAAAAEsE/N5LBUKpLtpsuh0Y70zINxlK9Ap3bIe1_wCHMYCw/s1600-h/image%255B64%255D"><img width="244" height="143" title="image" style="margin: 0px; display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-DqQ21Y0S2Ec/WgBRVCedGUI/AAAAAAAAEsI/sv1yIyJM7wg_klcpcODwxNs3aYRJ4JcvwCHMYCw/image_thumb%255B28%255D?imgmax=800" border="0"></a></p><p>You will get the actual PowerQuery <em>raw</em> <em>language </em>(it is a <a href="https://msdn.microsoft.com/en-us/library/mt211003.aspx">functional language</a> called M by the way <img class="wlEmoticon wlEmoticon-smile" style="" alt="Smile" src="https://lh3.googleusercontent.com/-6WMsjYyU5hU/WgBRWf9kWWI/AAAAAAAAEsM/6uOJsxKUt8MuLOJJ7igiU7wd5uom91p2wCHMYCw/wlEmoticon-smile%255B2%255D?imgmax=800">):</p><p><a href="https://lh3.googleusercontent.com/-VRJo2Ty-6uo/WgBRXkRXNrI/AAAAAAAAEsQ/Ol5B7YF6zcIgQsaXQd4skElNgaCeyj-RACHMYCw/s1600-h/image%255B68%255D"><img width="504" height="106" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Ki_YKKti4D8/WgBRY3lNdCI/AAAAAAAAEsU/OtsaOYPjeKow_t7zsao9x5qCNliDMUtPACHMYCw/image_thumb%255B30%255D?imgmax=800" border="0"></a></p><p>This is where you can start creating your custom transformations, leading to dynamic custom reports based on TFS/VSTS data. </p><p><a href="https://lh3.googleusercontent.com/-Ni638a-LJ0g/WgBRbmopzlI/AAAAAAAAEsY/a3movPFRsR4duwqmPUzWyWyfhwNQ2tGJACHMYCw/s1600-h/image%255B72%255D"><img width="504" height="135" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-gT2LyXB8lHA/WgBRc8mNdVI/AAAAAAAAEsc/l-sd_dH9h-wNFT1kOhPK1pNExWHobYuZwCHMYCw/image_thumb%255B32%255D?imgmax=800" border="0"></a></p><p><a href="https://lh3.googleusercontent.com/-ZkuwrVq0dvI/WgBReoi5n3I/AAAAAAAAEsg/Mw2fZR-qmXgYBL6fG4Bqv9ssuGtIA1xuQCHMYCw/s1600-h/image%255B76%255D"><img width="504" height="329" title="image" style="display: inline; background-image: none;" alt="image" src="https://lh3.googleusercontent.com/-Rw9eUUYDfyQ/WgBRgVw4aGI/AAAAAAAAEsk/qVz_dtfqAEkGBBnTHAEwVyBBOOJ-r220ACHMYCw/image_thumb%255B34%255D?imgmax=800" border="0"></a></p><p>I really find it cool and fascinating to be fair, bringing together such different user requirements and scenarios – without mentioning that you can up your percentage of Excel knowledge by a notch, which is always a great skill to master <img class="wlEmoticon wlEmoticon-smile" style="" alt="Smile" src="https://lh3.googleusercontent.com/-6WMsjYyU5hU/WgBRWf9kWWI/AAAAAAAAEsM/6uOJsxKUt8MuLOJJ7igiU7wd5uom91p2wCHMYCw/wlEmoticon-smile%255B2%255D?imgmax=800"></p>