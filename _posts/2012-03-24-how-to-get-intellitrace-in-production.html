---
layout: post
title: How to get IntelliTrace in production for Web Applications with Visual Studio
  11
date: '2012-03-24T08:53:00.001Z'
author: Matteo Emili
tags: 
modified_time: '2012-03-24T08:53:03.484Z'
thumbnail: http://lh3.ggpht.com/-lDU2WFoyM_E/T22LPkK3ouI/AAAAAAAAAIk/Bhu7WdV9OFA/s72-c/image_thumb6.png?imgmax=800
blogger_id: tag:blogger.com,1999:blog-9050180307874313601.post-408258533087569757
blogger_orig_url: https://mattvsts.blogspot.com/2012/03/how-to-get-intellitrace-in-production.html
---

<p>Until yesterday, IntelliTrace in production environment was not supported, so the usefulness of it was a bit argued.</p> <p>But now with Visual Studio 11, we can collect IntelliTrace logs from production environment in a completely supported way! And moreover, if you ask the Microsoft CSS (Customer Support Service) for help, the first question would be: “May you send me the IntelliTrace log please?”</p> <p>Before of configuring IntelliTrace logs collection, we have to set security for the IIS Application pool account:</p> <p><strong>icacls <em>sitepath</em> “<em>IIS APPPOOL\&lt;AppPool Account&gt;”:(F)</em></strong></p> <p><a href="http://lh3.ggpht.com/-h98cTkgjy7Q/T22LOvq3uxI/AAAAAAAAAIc/sy89Ca1Cd9Y/s1600-h/image12.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh3.ggpht.com/-lDU2WFoyM_E/T22LPkK3ouI/AAAAAAAAAIk/Bhu7WdV9OFA/image_thumb6.png?imgmax=800" width="487" height="149"></a></p> <p>Then, hands on the bits. Suppose we have a web application throwing an exception.</p> <p>Firstly, we have to deploy IntelliTrace to the target environment. Pretty easy, just extract content from the IntelliTraceCollection.cab file you can find under the <em>C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\CommonExtensions\Microsoft\IntelliTrace\11.0.0 </em>path.</p> <p>Then we have to extract it to the target server. I suggest using the <em>expand</em> command from a command prompt:</p> <p><strong>expand.exe /f:* IntelliTraceCollection.cab <em>path</em></strong></p> <p>Lastly, bring up PowerShell:</p> <p><a href="http://lh5.ggpht.com/-UlXDCH9Gh9c/T22LQVPG0UI/AAAAAAAAAIs/bTVB8tSlbcQ/s1600-h/image3.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh3.ggpht.com/-NLkd_867m7s/T22LSJJNhqI/AAAAAAAAAI0/YJee4byp95o/image_thumb1.png?imgmax=800" width="496" height="123"></a></p> <p>We have to load the IntelliTrace PowerShell Module:</p> <p><strong>Import-Module <em>sitepath\Microsoft.VisualStudio.IntelliTrace.PowerShell.dll</em></strong></p> <p>After doing so, we can get the full list of commands we can use:</p> <p><strong>Get-Command *IntelliTrace*</strong></p> <p><a href="http://lh3.ggpht.com/-IQbwKQbwVEA/T22LS0LGVII/AAAAAAAAAI4/PcWVSLoUg3M/s1600-h/image8.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh5.ggpht.com/-ksT8C7LKFr8/T22LUOeLyUI/AAAAAAAAAJE/WmIlF7FRN3M/image_thumb4.png?imgmax=800" width="493" height="170"></a></p> <p>And now we collect logs about the target application:</p> <p><strong>Start-IntelliTraceCollection <em>ApplicationPool CollectionPath OutputPath </em></strong></p> <p><strong>CollectionPath</strong> is the path we chose for IntelliTrace. In there, there are two “profiles”: <strong>collection_plan.ASP.NET.default.xml </strong>which collects only IntelliTrace events, and <strong>collection_plan.ASP.NET.trace.xml</strong>, which traces also function calls and events. </p> <p><strong>OutputPath</strong> is where we store logs.</p> <p><a href="http://lh4.ggpht.com/-CIG3_MM9dcs/T22LVIoOygI/AAAAAAAAAJI/dX7gb895jBU/s1600-h/image4.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh4.ggpht.com/-4rWG8RALaWI/T22LV5i7zyI/AAAAAAAAAJU/q-GLYpKnwUs/image_thumb11.png?imgmax=800" width="491" height="112"></a></p> <p>After deciding Yes (to all <img style="border-bottom-style: none; border-left-style: none; border-top-style: none; border-right-style: none" class="wlEmoticon wlEmoticon-smile" alt="Smile" src="http://lh5.ggpht.com/-Pam3pVyPSUE/T22LXRYK1ZI/AAAAAAAAAJc/ldplEjRwnkU/wlEmoticon-smile2.png?imgmax=800">) we have to run the application.</p> <p>When we got the error, we have to snapshot the log file:</p> <p><strong>Checkpoint-IntelliTraceCollection <em>ApplicationPool</em></strong></p> <p><a href="http://lh6.ggpht.com/--KuCgaHaUqQ/T22LYCHIz-I/AAAAAAAAAJk/mgvZhlZ-TxA/s1600-h/image81.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh4.ggpht.com/-Iq5WB2__s54/T22LZKXiSTI/AAAAAAAAAJo/39hpIBJispU/image_thumb3.png?imgmax=800" width="490" height="97"></a></p> <p><strong></strong></p> <p>And then we have to stop collecting it.</p> <p><strong>Stop-IntelliTraceCollection <em>ApplicationPool</em></strong></p> <p><a href="http://lh5.ggpht.com/-YGrz_wZ0NZM/T22LZzyszGI/AAAAAAAAAJ0/RksCNbNA7VU/s1600-h/image121.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://lh5.ggpht.com/-vcvH8EtHYog/T22LbZHGmuI/AAAAAAAAAJ8/UCLso5pvrrA/image_thumb5.png?imgmax=800" width="494" height="73"></a></p> <p>That’s all: we have the logs.</p> <p>To analyse them, it’s just a classic IntelliTrace analysis as we always did.</p>  