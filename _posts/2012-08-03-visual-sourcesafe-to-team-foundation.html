---
layout: post
title: Visual SourceSafe to Team Foundation Server step by step
date: '2012-08-03T08:51:00.000+01:00'
author: Matteo Emili
tags: 
modified_time: '2012-08-03T09:01:50.182+01:00'
thumbnail: http://lh6.ggpht.com/-NI9Qk5HyYvM/UBr_NSmu5GI/AAAAAAAAAYo/XpkdeTKq67w/s72-c/wlEmoticon-smile%25255B2%25255D.png?imgmax=800
blogger_id: tag:blogger.com,1999:blog-9050180307874313601.post-6335186529918099525
blogger_orig_url: https://mattvsts.blogspot.com/2012/08/visual-sourcesafe-to-team-foundation.html
---

As I <a href="http://twitter.com/MattVSTS/status/223069339752988673">tweeted</a> some weeks ago, the Visual SourceSafe 2005 support expired July 10th, 2012. So it is no more a <strong>supported</strong> solution from Microsoft.<br /><br />If you have some Visual SourceSafe still lying around your datacentre, here’s how to kill them with no pain <img alt="Smile" class="wlEmoticon wlEmoticon-smile" src="http://lh6.ggpht.com/-NI9Qk5HyYvM/UBr_NSmu5GI/AAAAAAAAAYo/XpkdeTKq67w/wlEmoticon-smile%25255B2%25255D.png?imgmax=800" /><br /><br />First of all: you’re going to need the VSSConverter, a fantastic tool contained in the Visual Studio installation, under<br /><br /><strong>&lt;drive&gt;:\Program Files\Microsoft Visual Studio 10.0\Common7\IDE</strong><br /><br />Beware: with Team Foundation Server 2012 there’s going to be a new tool to perform migrations. I’m going to post something on the new tool as soon as I can, but for now this is the only way to migrate it. Moreover, if you won’t have Team Foundation Server 2012, you have not that much possibilities…<img alt="Smile" class="wlEmoticon wlEmoticon-smile" src="http://lh6.ggpht.com/-NI9Qk5HyYvM/UBr_NSmu5GI/AAAAAAAAAYo/XpkdeTKq67w/wlEmoticon-smile%25255B2%25255D.png?imgmax=800" /><br /><br />I strongly suggest you to copy the VSSConverter and its related files inside a folder, like <strong>&lt;drive&gt;:\Migration</strong>, in order to keep everything simple.<br /><br />Then you have to create two XML files: one is for the Analysis, and the other for the Migration. I won’t go into details, everything you need about those files are into the MSDN but…I provide you two samples <img alt="Smile" class="wlEmoticon wlEmoticon-smile" src="http://lh6.ggpht.com/-NI9Qk5HyYvM/UBr_NSmu5GI/AAAAAAAAAYo/XpkdeTKq67w/wlEmoticon-smile%25255B2%25255D.png?imgmax=800" /> here’s one for the <a href="https://skydrive.live.com/redir?resid=4F49EBA58E1D0C02!481&amp;authkey=!ALlL9-N2J6gK-z0">Analysis</a>, and here’s the other for the <a href="https://skydrive.live.com/redir?resid=4F49EBA58E1D0C02!482&amp;authkey=!APxfz_T__CJgfoo">Migration</a>.<br /><br />To analyze the Visual SourceSafe database, use the following command (from an elevated command prompt):<br /><br /><strong>vssconverter.exe analyze analysissettings.xml</strong><br /><br />It analyzes the Visual SourceSafe database (or part of it), and provides us a report, to understand whether there are errors, and a UserMap.xml file. Inside of it we can find the Visual SourceSafe users to map to the correct Active Directory user in Team Foundation Server.<br /><br />What does it happen if I don’t map a user (for various reasons)? Well…despite it’s <strong>strongly suggested</strong> to do so, the difference in behavior is the following:<br /><br /><strong>With:</strong><br />Changeset 4121 – Committed by DOMAIN\UserWhoDidIt – Comment<br /><br /><strong>Without:</strong><br />Changeset 4121 – Committed by DOMAIN\MigrationUser – Comment (Committed by UserWhoDidIt)<br /><br />After finalizing the user mapping, we use the following command to migrate:<br /><br /><strong>vssconverter.exe migrate migrationsettings.xml</strong><br /><br />And the migration takes place <img alt="Smile" class="wlEmoticon wlEmoticon-smile" src="http://lh6.ggpht.com/-NI9Qk5HyYvM/UBr_NSmu5GI/AAAAAAAAAYo/XpkdeTKq67w/wlEmoticon-smile%25255B2%25255D.png?imgmax=800" /> that’s it!