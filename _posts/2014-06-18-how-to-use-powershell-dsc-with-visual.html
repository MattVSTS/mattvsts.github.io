---
layout: post
title: How to use PowerShell DSC with Visual Studio Release Management
date: '2014-06-18T11:46:00.001+01:00'
author: Matteo Emili
tags: 
modified_time: '2014-06-18T14:15:41.280+01:00'
thumbnail: http://lh3.ggpht.com/-qCmKDtBYGjY/U6Ft-8t6UKI/AAAAAAAABZ0/CouYxqev-Jk/s72-c/image_thumb%25255B2%25255D.png?imgmax=800
blogger_id: tag:blogger.com,1999:blog-9050180307874313601.post-8610626052015675100
blogger_orig_url: https://mattvsts.blogspot.com/2014/06/how-to-use-powershell-dsc-with-visual.html
---

<p>After the brief introduction earlier this month it is now time to push forward – let’s see how the Update 3 CTP of Visual Studio Release Management enables you to push your DSC scripts to the target machines.</p> <p>Firstly, the script. To keep things simple, I decided to deploy my script in an independent build and then leverage on VSRM for the deployment – no build template integration.</p> <div id="scid:C89E2BDB-ADD3-4f7a-9810-1B7EACF446C1:1f4863b1-6932-4a10-8943-fd3c1894731b" class="wlWriterEditableSmartContent" style="float: none; padding-bottom: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px"><pre style=white-space:normal><br />[sourcecode language='powershell' ]<br />Configuration DemoAppConfig<br />{<br />    param($servers=&quot;localhost&quot;,<br />    [String]$SourcePath = '\\dtfsat\Build',<br />    [String]$AppPath = 'C:\AppPath'<br />    )<br />    Node $servers<br />    {<br />        File CopyApp<br />        {<br />        Ensure = 'Present'<br />        Type = &quot;Directory&quot;<br />        Recurse = $true<br />        SourcePath = $SourcePath<br />        DestinationPath = $AppPath<br />        }<br />    }<br />}<br /><br />DemoAppConfig<br /><br />[/sourcecode]<br /></pre><br /></div><br /><p></p><br /><p>Then we can create a new <strong>Standard Environment:</strong></p><br /><p><a href="http://lh6.ggpht.com/-0GoYTFRcjEc/U6Ft-UILH_I/AAAAAAAABZw/NI55GdICkZo/s1600-h/image%25255B6%25255D.png"><img title="image" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="image" src="http://lh3.ggpht.com/-qCmKDtBYGjY/U6Ft-8t6UKI/AAAAAAAABZ0/CouYxqev-Jk/image_thumb%25255B2%25255D.png?imgmax=800" width="244" height="15"></a> </p><br /><p>which is going to contain our <strong>agentless target server</strong>. To configure a target server, you’d need to run <strong>Enable-PSRemoting –force </strong>and <strong>winrm qc –transport:HTTP</strong> from PowerShell.</p><br /><p>This server must be added using the FQDN and the listener port – the 5985 is the default port used by the HTTP listener.</p><br /><p><a href="http://lh3.ggpht.com/-jroYi0oEx-U/U6Ft_aqUdsI/AAAAAAAABaA/3O3wBGAHFfE/s1600-h/image%25255B12%25255D.png"><img title="image" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="image" src="http://lh5.ggpht.com/-vqdXDQ9vYzQ/U6Ft_1rgP3I/AAAAAAAABaI/HYMGmQPxNX8/image_thumb%25255B4%25255D.png?imgmax=800" width="244" height="182"></a> </p><br /><p>This server is always going to be in a <strong>Ready</strong> status as long as there are the required permissions in place. </p><br /><p>The only missing bits are the Component and the Release Template. As mentioned, the Component is going to be picked from an external network share (the build drop location) and used as-is. This is just for this sample anyway, the standard Build Definition used by VSRM would work as usual. </p><br /><p>The big difference stands in the Deployment Tool used for the component – it is going to be <strong>Run PowerShell on Standard Environment</strong>, which provides all the facilities for running the DSC script:</p><br /><p><a href="http://lh5.ggpht.com/-vv90O8mgIyY/U6FuAcH2N2I/AAAAAAAABaQ/x6a-iAu0PPs/s1600-h/image%25255B15%25255D.png"><img title="image" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="image" src="http://lh4.ggpht.com/-ZbHWoW4MLJo/U6FuA-3zSOI/AAAAAAAABaU/TQSp_KEssKE/image_thumb%25255B5%25255D.png?imgmax=800" width="244" height="89"></a> </p><br /><p>This is going to be our single entrypoint for running DSC script. Moreover – if you look at the Release Template toolbox it is quite…empty:</p><br /><p><a href="http://lh4.ggpht.com/-Nx_shb-0RZs/U6FuBD7GvQI/AAAAAAAABag/H41tUPuy6h0/s1600-h/image%25255B18%25255D.png"><img title="image" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="image" src="http://lh3.ggpht.com/-W5EDDiLbi5k/U6FuBwMuUuI/AAAAAAAABak/rcm5z854XeI/image_thumb%25255B6%25255D.png?imgmax=800" width="178" height="244"></a> </p><br /><p>But it would work like a charm :) The Deployment Sequence is going to be pretty lean as well: invoking the Component’s deployment for the target server – and that’s all:</p><br /><p><a href="http://lh6.ggpht.com/-W80THvtI124/U6FuCFI4AuI/AAAAAAAABaw/0k-TO3tw7_c/s1600-h/image%25255B21%25255D.png"><img title="image" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="image" src="http://lh5.ggpht.com/-VV6T5xoNy40/U6FuCyoMdCI/AAAAAAAABa4/vmGuE02kWek/image_thumb%25255B7%25255D.png?imgmax=800" width="235" height="244"></a> </p><br /><p>This is what you are going to need to create a basic DSC-based deployment using Visual Studio Release Management. No rocket science required!</p>  