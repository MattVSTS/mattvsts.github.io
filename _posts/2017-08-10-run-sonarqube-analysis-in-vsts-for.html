---
layout: post
title: Run a SonarQube analysis in VSTS for unsupported .NET Core projects
date: '2017-08-10T09:48:00.001+01:00'
author: Matteo Emili
tags: 
modified_time: '2017-08-10T09:48:17.962+01:00'
thumbnail: https://lh3.googleusercontent.com/-1DhR-Ez_vQU/WYwdxvUN_XI/AAAAAAAAEiU/jOiPsx1fCHIR9VrJGnGakxCtn_n00XIZgCHMYCw/s72-c/sq0_thumb?imgmax=800
blogger_id: tag:blogger.com,1999:blog-9050180307874313601.post-881729661543011738
blogger_orig_url: https://mattvsts.blogspot.com/2017/08/run-sonarqube-analysis-in-vsts-for.html
---

<p>With some projects you might face this:</p><p><strong>error MSB4062: The "IsTestFileByName" task could not be loaded from the assembly &lt;path&gt;\.sonarqube\bin\SonarQube.Integration.Tasks.dll.</strong><p>It is a <a href="https://jira.sonarsource.com/browse/SONARMSBRU-310">known issue</a> I’m afraid, involving (among the others) .NET Standard. <p>There is a fairly straightforward workaround IMHO. Instead of using the Scanner for MSBuild as you would, use the CLI scanner that is now provided by VSTS:<p><a href="https://lh3.googleusercontent.com/-Fcpm7Xuu7Dk/WYwdwnCYlgI/AAAAAAAAEiQ/enQs6NSg-mYaCQujqqyEhmW36TueloOyQCHMYCw/s1600-h/sq0%255B2%255D"><img width="244" height="109" title="sq0" style="display: inline; background-image: none;" alt="sq0" src="https://lh3.googleusercontent.com/-1DhR-Ez_vQU/WYwdxvUN_XI/AAAAAAAAEiU/jOiPsx1fCHIR9VrJGnGakxCtn_n00XIZgCHMYCw/sq0_thumb?imgmax=800" border="0"></a><p>This is enough to let the scanner do its job. This approach can bring a different issue – if you <a href="http://mattvsts.blogspot.co.uk/2017/06/a-few-nuggets-from-using-tfsvsts-and.html">use branches</a> to identify projects in SonarQube, or if you have dynamically set properties, and having a fixed, static properties file doesn’t really work.<p>Still, nothing really blocking. Do you see the PowerShell Script above? <img class="wlEmoticon wlEmoticon-smile" style="" alt="Smile" src="https://lh3.googleusercontent.com/-Q8FAyUPbyb0/WYwdyZMy9aI/AAAAAAAAEiY/FFH2HgZqqPQgtD0suyQGRDrBUTdBy0cNACHMYCw/wlEmoticon-smile%255B2%255D?imgmax=800"><p><a href="https://lh3.googleusercontent.com/-tM20oUejKHM/WYwdzd_xeYI/AAAAAAAAEic/tgyo2hYpTVgGNRGGcsHfDA3722j02Vl7wCHMYCw/s1600-h/sq1%255B3%255D"><img width="504" height="264" title="sq1" style="display: inline; background-image: none;" alt="sq1" src="https://lh3.googleusercontent.com/-KvvUE4xENBA/WYwd0fyDcjI/AAAAAAAAEig/ePY_5DcmNtEIwsmCTXYMUHhOd4BPZOS_wCHMYCw/sq1_thumb%255B1%255D?imgmax=800" border="0"></a><p>This is an example of what you can do – a bit rough, it just adds a line at the end of the file stating the branch to analyse. It can also be much cleaner, but still <img class="wlEmoticon wlEmoticon-smile" style="" alt="Smile" src="https://lh3.googleusercontent.com/-Q8FAyUPbyb0/WYwdyZMy9aI/AAAAAAAAEiY/FFH2HgZqqPQgtD0suyQGRDrBUTdBy0cNACHMYCw/wlEmoticon-smile%255B2%255D?imgmax=800"></p><p>Remember that you can always manipulate files in the agent, and that’s what I do. Add whatever line you want with a script like this so that you have granular control in the same way as adding <strong>/d:…</strong> to the parameters in the regular MSBuild task.</p>