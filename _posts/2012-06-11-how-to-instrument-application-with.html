---
layout: post
title: How to instrument an application with PreEmptive Analytics for Team Foundation
  Server
date: '2012-06-11T18:11:00.001+01:00'
author: Matteo Emili
tags: 
modified_time: '2012-06-11T18:11:40.925+01:00'
thumbnail: http://lh6.ggpht.com/-A7Z9Cz1Cq4I/T9YmcG0H7yI/AAAAAAAAASY/RRAGBYJWh3I/s72-c/pa1_thumb.png?imgmax=800
blogger_id: tag:blogger.com,1999:blog-9050180307874313601.post-8841920893385256689
blogger_orig_url: https://mattvsts.blogspot.com/2012/06/how-to-instrument-application-with.html
---

<p>As I previously posted, in this release we have a powerful instrumentation tool for our exceptions: PreEmptive Analytics.</p> <p>Given the required server side configuration, here’s what’s needed on the client side:</p> <p>Open up Dotfuscator:</p> <p>&nbsp;<a href="http://lh3.ggpht.com/-_ku9QIUQFbM/T9YmbTpz4jI/AAAAAAAAASQ/7u3YrwuQpDk/s1600-h/pa12.png"><img title="pa1" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="pa1" src="http://lh6.ggpht.com/-A7Z9Cz1Cq4I/T9YmcG0H7yI/AAAAAAAAASY/RRAGBYJWh3I/pa1_thumb.png?imgmax=800" width="244" height="116"></a></p> <p>Set a new executable to target:</p> <p><a href="http://lh4.ggpht.com/-GTqrONJGi28/T9YmcvXrVOI/AAAAAAAAASg/wNzTDfphG0c/s1600-h/pa22.png"><img title="pa2" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="pa2" src="http://lh5.ggpht.com/-fxE1wlqiW48/T9YmdbHhxlI/AAAAAAAAASo/j7-n71_aW8E/pa2_thumb.png?imgmax=800" width="244" height="160"></a></p> <p><a href="http://lh5.ggpht.com/-jFh63-XwAEg/T9YmdvxkCAI/AAAAAAAAASw/RqiT38xj9Xc/s1600-h/pa32.png"><img title="pa3" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="pa3" src="http://lh3.ggpht.com/-lk033WWpamo/T9YmeRkvM_I/AAAAAAAAAS4/b0-X2rhqXXk/pa3_thumb.png?imgmax=800" width="219" height="118"></a></p> <p>Then select Analytics…</p> <p><a href="http://lh3.ggpht.com/-G3BGxgGfNjs/T9Yme8atECI/AAAAAAAAATA/-CDD1CNoWgg/s1600-h/pa42.png"><img title="pa4" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="pa4" src="http://lh6.ggpht.com/-YkMRQtyLhFY/T9YmgN-DBtI/AAAAAAAAATI/v_X8Cn59zKI/pa4_thumb.png?imgmax=800" width="149" height="70"></a></p> <p><a href="http://lh4.ggpht.com/-JuDFscGnFqQ/T9Ymg4lanZI/AAAAAAAAATQ/jHtSHF2la_U/s1600-h/pa52.png"><img title="pa5" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="pa5" src="http://lh3.ggpht.com/-uZoizaFvN3Q/T9YmiF5U_YI/AAAAAAAAATY/UeendhVuVnA/pa5_thumb.png?imgmax=800" width="244" height="129"></a></p> <p>…and we start adding attributes:</p> <p><a href="http://lh6.ggpht.com/-HdQOkpk1YeM/T9Ymi1fwckI/AAAAAAAAATg/KOfYAG4JNDY/s1600-h/pa62.png"><img title="pa6" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="pa6" src="http://lh5.ggpht.com/-2kq63wx-Mxw/T9Ymjt2cH6I/AAAAAAAAATo/g6K73fjgH4Y/pa6_thumb.png?imgmax=800" width="244" height="119"></a><a href="http://lh3.ggpht.com/-6PhBU9e-ofc/T9YmkOhYUII/AAAAAAAAATw/z0E3II7vhgQ/s1600-h/pa72.png"><img title="pa7" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="pa7" src="http://lh5.ggpht.com/-EeurjJjKhgk/T9YmkhkQYEI/AAAAAAAAAT4/br6CTim1jCI/pa7_thumb.png?imgmax=800" width="244" height="154"></a></p> <p>One of the few things we need is an Application ID:</p> <p><a href="http://lh4.ggpht.com/-10EeXmJ1cm0/T9YmlQFM2mI/AAAAAAAAAUA/fVA-IzwHNns/s1600-h/pa82.png"><img title="pa8" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="pa8" src="http://lh4.ggpht.com/-m4IMDKuqie0/T9YmmEGpUdI/AAAAAAAAAUI/ZcuAELgipcA/pa8_thumb.png?imgmax=800" width="244" height="34"></a></p> <p><a href="http://lh5.ggpht.com/-46msy4aO9SE/T9YmmneAMTI/AAAAAAAAAUQ/Wl1p4sbIXgw/s1600-h/pa92.png"><img title="pa9" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="pa9" src="http://lh4.ggpht.com/-Tb8rHRbaJNU/T9YmnKzNd2I/AAAAAAAAAUY/epVZUW5TRj0/pa9_thumb.png?imgmax=800" width="244" height="71"></a></p> <p>Then we add the SetupAttribute to instrument our methods:</p> <p><a href="http://lh6.ggpht.com/-2jrfZC1UxkA/T9YmnwFMllI/AAAAAAAAAUg/FPQ2WFzOCAo/s1600-h/pa102.png"><img title="pa10" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="pa10" src="http://lh4.ggpht.com/-ULUeM7LXFwY/T9YmoSGsLDI/AAAAAAAAAUo/w5uug2vSgCY/pa10_thumb.png?imgmax=800" width="139" height="244"></a></p> <p><a href="http://lh6.ggpht.com/-HeXa4gMJu3A/T9Ymo7kEdEI/AAAAAAAAAUw/ZYl5tlrWKaw/s1600-h/pa112.png"><img title="pa11" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="pa11" src="http://lh5.ggpht.com/-FrPgkVeyz3k/T9YmprfIHRI/AAAAAAAAAU4/JRgbNGvAUtw/pa11_thumb.png?imgmax=800" width="244" height="148"></a></p> <p>Here we need to configure the Endpoint: as a default setting, the address to set is <strong>tfsserver:8000/Message/Endpoint.ashx</strong></p> <p><a href="http://lh4.ggpht.com/-lSpFEnSsjvg/T9YmqFft7DI/AAAAAAAAAVA/8_d0G-MWB8c/s1600-h/pa122.png"><img title="pa12" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="pa12" src="http://lh5.ggpht.com/-tDfuHLWLUWI/T9YmqgPkzUI/AAAAAAAAAVI/VYDoFfCsajQ/pa12_thumb.png?imgmax=800" width="244" height="48"></a></p> <p><a href="http://lh5.ggpht.com/-jhASLHkKnno/T9YmrTp9wuI/AAAAAAAAAVQ/DaoLXfKoes4/s1600-h/pa132.png"><img title="pa13" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="pa13" src="http://lh6.ggpht.com/-raaKSNdwYKc/T9YmsDWn8QI/AAAAAAAAAVY/VA2ua-ei6go/pa13_thumb.png?imgmax=800" width="181" height="244"></a></p> <p>The Teardown attribute is needed to clean up after the execution;</p> <p><a href="http://lh3.ggpht.com/--kqwGsdlLD0/T9YmsihKnaI/AAAAAAAAAVg/eBiMcwdI1Y0/s1600-h/pa142.png"><img title="pa14" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="pa14" src="http://lh3.ggpht.com/-ROibK1gs64Q/T9YmtQTnhqI/AAAAAAAAAVo/u1rjyefxYd0/pa14_thumb.png?imgmax=800" width="244" height="163"></a></p> <p>The only missing stuff is the configuration itself:<a href="http://lh5.ggpht.com/-bRROIur53KE/T9Ymt-krL_I/AAAAAAAAAVw/uolWC3wN8BI/s1600-h/pa152.png"><img title="pa15" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="pa15" src="http://lh6.ggpht.com/-dMBNMnI1y3M/T9Ymuq7ZuaI/AAAAAAAAAV4/aH6kcpN0cDc/pa15_thumb.png?imgmax=800" width="244" height="163"></a></p> <p>We go creating a new subscription:</p> <p><a href="http://lh6.ggpht.com/-3l_OlSGAsFc/T9YmvOr33kI/AAAAAAAAAWA/D8NMe9cI5g0/s1600-h/pa162.png"><img title="pa16" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="pa16" src="http://lh5.ggpht.com/-GIvako_UcB4/T9YmwvEsFjI/AAAAAAAAAWI/TeefuHqsglY/pa16_thumb.png?imgmax=800" width="244" height="94"></a></p> <p>Copy-paste the IDs needed (Company and Application). The most important setting here is the <strong>Threshold</strong>: if we set it to 1, we’ll have an <strong>Incident</strong> work item for <strong>every</strong> time the exception raises.</p> <p><a href="http://lh3.ggpht.com/-1xKfmF6cB24/T9YmxSKj5RI/AAAAAAAAAWQ/XW6rlUMAw08/s1600-h/pa172.png"><img title="pa17" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="pa17" src="http://lh6.ggpht.com/-_nogUaRbW1Q/T9YmybJu9II/AAAAAAAAAWY/FvfJhmZcn6g/pa17_thumb.png?imgmax=800" width="244" height="172"></a></p> <p>That’s it people <img class="wlEmoticon wlEmoticon-smile" style="border-top-style: none; border-left-style: none; border-bottom-style: none; border-right-style: none" alt="Smile" src="http://lh3.ggpht.com/-VD917qXYpL4/T9Ymyy35FJI/AAAAAAAAAWg/Zl28zpOZfTg/wlEmoticon-smile2.png?imgmax=800"></p>  