---
layout: post
title: Easily handle internal settings while orchestrating components' deployments
  and parameters
date: '2018-06-20T10:24:00.002+01:00'
author: Matteo Emili
tags: 
modified_time: '2018-06-20T10:24:43.313+01:00'
thumbnail: https://2.bp.blogspot.com/-cjUM2YV1o-M/WyocpxO0sfI/AAAAAAAAE70/oByyz9agb0ESsWz3CP2M_TSXeSMd5RYXQCLcBGAs/s72-c/set0.PNG
blogger_id: tag:blogger.com,1999:blog-9050180307874313601.post-1521946398574147749
blogger_orig_url: https://mattvsts.blogspot.com/2018/06/easily-handle-internal-settings-while.html
---

<div dir="ltr" style="text-align: left;" trbidi="on">After ten years of attending, then speaking at conferences it always strikes me what demos often miss are real world details that really make the difference.<br /><br />Like...deploying an application with a pipeline. Everybody talks about it, right? And everybody (including myself!) have some demo-ready stuff to show around in case it might be required.<br /><br />I am working on a sample application right now, and I realised how blind I was - even if I am deploying stuff to different slots and environments and whatnot, I am still treating everything as a single monolith. Not really what you want these days, right?<br /><br />Well' let's sort it out. Say that you have an API component and a Frontend component, the best thing to do is to decouple the two of them so they can be independently deployed *and* mix-matched depending on the requirement.<br /><br />It is .NET Core in my case, so in my Frontend component's appsettings.json I created this section:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-cjUM2YV1o-M/WyocpxO0sfI/AAAAAAAAE70/oByyz9agb0ESsWz3CP2M_TSXeSMd5RYXQCLcBGAs/s1600/set0.PNG" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="77" data-original-width="348" src="https://2.bp.blogspot.com/-cjUM2YV1o-M/WyocpxO0sfI/AAAAAAAAE70/oByyz9agb0ESsWz3CP2M_TSXeSMd5RYXQCLcBGAs/s1600/set0.PNG" /></a></div><br /><br /><br /><br /><br /><br /><br />Of course I modified the application so I could add the configuration in my ConfigureServices method and consume it in my Controller. The variable part in this case is the Slot property.<br /><br />Now comes the fun side of the story - of course I have a pipeline in place. How do I handle these settings?<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/--ahuv9WIfYY/Wyocp4I8B1I/AAAAAAAAE74/3_OYjvW6o3wItq4iOVUwqMWfoaywJZSjwCLcBGAs/s1600/set1.PNG" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="249" data-original-width="1268" height="123" src="https://1.bp.blogspot.com/--ahuv9WIfYY/Wyocp4I8B1I/AAAAAAAAE74/3_OYjvW6o3wItq4iOVUwqMWfoaywJZSjwCLcBGAs/s640/set1.PNG" width="640" /></a></div><br /><br />The best approach here, given the relative complexity of this exercise, is to scope the relevant value by environment. The Dev environment will always point at the Dev environment, Staging to Staging, and the last two environments are effectively production so I do not need to worry about adding a slot. It's not like I have cross-environment settings here.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-gmZfBUP6Q9s/WyocpxxBF_I/AAAAAAAAE78/rCqkhFA9Iw421bQiWDncBfpCsgb9Yg0ggCLcBGAs/s1600/set2.PNG" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="115" data-original-width="988" height="72" src="https://2.bp.blogspot.com/-gmZfBUP6Q9s/WyocpxxBF_I/AAAAAAAAE78/rCqkhFA9Iw421bQiWDncBfpCsgb9Yg0ggCLcBGAs/s640/set2.PNG" width="640" /></a></div><br /><br /><br /><br /><br />The reason why the variables are named that way is because I am using the JSON variable substitution option in the Azure App Service Deploy task, and as my property is not on the first level then it needs to be explicitly written that way.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-vfM2D6Yi_wk/WyocqTIjtPI/AAAAAAAAE8A/Z65pV4iXO0AcVwgRMcazv-WBckUWtMvTgCLcBGAs/s1600/set3.PNG" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" data-original-height="286" data-original-width="1010" height="179" src="https://4.bp.blogspot.com/-vfM2D6Yi_wk/WyocqTIjtPI/AAAAAAAAE8A/Z65pV4iXO0AcVwgRMcazv-WBckUWtMvTgCLcBGAs/s640/set3.PNG" width="640" /></a></div><br /><br /><br /><br /><br /><br />Doing it ensures that each environment has its own setting, and it also makes sure you remain sane while handling internal app settings across your applications and environments ðŸ˜‰ it is really easy to do as well, so there is really no reason to skimp on it.</div>