---
layout: post
title: The TFS’ Excel Reports won’t load after a SharePoint change – why?
date: '2014-05-21T16:52:00.001+01:00'
author: Matteo Emili
tags: 
modified_time: '2014-05-21T16:53:39.776+01:00'
thumbnail: http://lh6.ggpht.com/-uBxpdD5xglo/U3zLvg7HAfI/AAAAAAAABXQ/pnRUWTiHVYE/s72-c/clip_image002_thumb.jpg?imgmax=800
blogger_id: tag:blogger.com,1999:blog-9050180307874313601.post-3957561776387073279
blogger_orig_url: https://mattvsts.blogspot.com/2014/05/the-tfs-excel-reports-wont-load-after.html
---

<p>I experienced a situation where the SharePoint instance used by a Team Foundation Server suddenly started raising errors while loading the Excel Reports inside a page.</p> <p>The error was “<strong>An error occurred during an attempt to estabilish a connection to the external data source. The following connections failed to refresh: TfsOlapReport</strong>”</p> <p><a href="http://lh5.ggpht.com/-Mfz41OK5EF4/U3zLvAy8qcI/AAAAAAAABXM/B20quJ76d4c/s1600-h/clip_image002%25255B3%25255D.jpg"><img title="clip_image002" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="clip_image002" src="http://lh6.ggpht.com/-uBxpdD5xglo/U3zLvg7HAfI/AAAAAAAABXQ/pnRUWTiHVYE/clip_image002_thumb.jpg?imgmax=800" width="244" height="135"></a></p> <p>But – if I tried to open them they were fine, after a refresh. What the heck?</p> <p>The answer seems easy for a SharePoint expert but not for someone who tries to steer clear from it…:) basically the <strong>Secure Store Service</strong> is used to authenticate the requests TFS does using the SharePoint’s services.</p> <p>Here is the issue – do not ask me <strong>why</strong>, but after a change on the SharePoint side (possibly due to a reconfiguration), the Authentication Setting for my report’s connection changed. In order to work, the report must use the “<strong>TFS</strong>”&nbsp; SSS token – and not the user itself.</p> <p><a href="http://lh3.ggpht.com/-O-LNQSK4GLw/U3zLwEsSNWI/AAAAAAAABXc/F_Ezc6GTwKI/s1600-h/image%25255B2%25255D.png"><img title="image" style="border-top: 0px; border-right: 0px; border-bottom: 0px; border-left: 0px; display: inline" border="0" alt="image" src="http://lh4.ggpht.com/-5Dx7QFPZy_o/U3zLwqT5mDI/AAAAAAAABXk/vOo7qSnlm04/image_thumb.png?imgmax=800" width="244" height="175"></a> </p> <p>After resetting this, and double checking the SharePoint settings together with a specialist, everything worked as expected.</p>  