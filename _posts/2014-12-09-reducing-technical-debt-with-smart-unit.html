---
layout: post
title: Reducing Technical Debt with Smart Unit Tests
date: '2014-12-09T11:53:00.001Z'
author: Matteo Emili
tags: 
modified_time: '2014-12-09T11:53:21.193Z'
thumbnail: http://lh5.ggpht.com/-1NxWhys2Ajk/VIbim6ijJXI/AAAAAAAABrg/iXKPgVkLAcI/s72-c/image_thumb.png?imgmax=800
blogger_id: tag:blogger.com,1999:blog-9050180307874313601.post-6131554088060967022
blogger_orig_url: https://mattvsts.blogspot.com/2014/12/reducing-technical-debt-with-smart-unit.html
---

<p>One of the reasons behind <a href="http://en.wikipedia.org/wiki/Technical_debt">Technical Debt</a> is the <strong>lack of appropriate test suites</strong> around a certain feature. Especially when implementing something new, tests are critical in shaping a robust and quality solution. Often, if you have something <em>in the works</em> and you are not strictly operating TDD, <strong>tests are behind</strong> where they should be.</p> <p>Visual Studio 2015 introduced Smart Unit Tests, which are nothing but the former MSR Pex project, rebranded and productised. What Pex/a Smart Unit Test does is to analyse your code and create a basic suite of unit tests to test the <strong>basic, border scenarios</strong>. Here is an example:</p> <p><a href="http://lh6.ggpht.com/-ZZeY9RW6UzU/VIbimXUa1YI/AAAAAAAABrY/ZAJmcE1cjUg/s1600-h/image%25255B2%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="image" src="http://lh5.ggpht.com/-1NxWhys2Ajk/VIbim6ijJXI/AAAAAAAABrg/iXKPgVkLAcI/image_thumb.png?imgmax=800" width="221" height="97"></a> </p> <p>Right click on the method, <strong>Smart Unit Tests</strong>…</p> <p><a href="http://lh3.ggpht.com/-CAn2Sbwn8K0/VIbinUCHIeI/AAAAAAAABrk/YfK9Niy8ao4/s1600-h/image%25255B5%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="image" src="http://lh4.ggpht.com/-6u9KA4dmrMg/VIbinwyiq9I/AAAAAAAABrw/mPZr0LPO0Ko/image_thumb%25255B1%25255D.png?imgmax=800" width="244" height="94"></a> </p> <p>and here is the result:</p> <p><a href="http://lh6.ggpht.com/-UhT14Y1cGTY/VIbioVie6xI/AAAAAAAABr0/mIS80wb8y8E/s1600-h/image%25255B20%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="image" src="http://lh6.ggpht.com/-y0v6h61GBLA/VIbioyUUylI/AAAAAAAABr8/uD-niaO84c4/image_thumb%25255B8%25255D.png?imgmax=800" width="507" height="163"></a> </p> <p>Of course – this is a really, really basic scenario. What is interesting IMHO is how it is doing it <em>behind the scenes</em>:</p> <p><a href="http://lh6.ggpht.com/-06f5Z7VlhhE/VIbipDC7akI/AAAAAAAABsE/BY8Cl87MpnQ/s1600-h/image%25255B11%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="image" src="http://lh4.ggpht.com/-967e3WHXTcY/VIbip1L60MI/AAAAAAAABsM/16Rkg1_oc8I/image_thumb%25255B3%25255D.png?imgmax=800" width="236" height="183"></a> </p> <p>as mentioned, it is a <strong>full-fledged Unit Test</strong>. Very basic, but still a good starting point, <strong>saving time </strong>while in the works. And if you save it, the Smart Unit Test engine is automatically going to create a new Test Project with the aforementioned tests contained in there. Again, it is not meant to remain as-is (“Sum748” is not a great test name for instance…) but it is still better IMHO than doing everything on my own.</p> <p>Let’s make things a bit <em>harder</em> now:</p> <p><a href="http://lh5.ggpht.com/-faShiYzL3ZQ/VIbiqGxah8I/AAAAAAAABsU/6IuRADRJob4/s1600-h/image%25255B14%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="image" src="http://lh5.ggpht.com/-GR6keaS7FiU/VIbiq15XRTI/AAAAAAAABsc/CqEhtXlzmtc/image_thumb%25255B4%25255D.png?imgmax=800" width="239" height="94"></a> </p> <p>That is <strong>very crappy code</strong> in small scale. No exception management at all, just the plain and down-to-the-bone feature, potentially <em>in development</em>. I can ear people screaming, but it happens extremely often in every organisation. This is the output of Smart Unit Test in this scenario:</p> <p><a href="http://lh6.ggpht.com/-qubAwLfWXP0/VIbirUIqbUI/AAAAAAAABso/feEBldLUrps/s1600-h/image%25255B21%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; border-bottom-width: 0px; display: inline; border-top-width: 0px" border="0" alt="image" src="http://lh6.ggpht.com/-eQbENuaknoU/VIbir2A8DWI/AAAAAAAABss/Qs0AQ4dvMW0/image_thumb%25255B9%25255D.png?imgmax=800" width="474" height="104"></a> </p> <p>It seems I need to spend some time on handling <strong>DivideByZeroExceptions</strong> and <strong>OverflowExceptions</strong>, to begin with…</p>  